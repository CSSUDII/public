"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _jsonwebtoken = _interopRequireDefault(require("jsonwebtoken"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

/* eslint-disable @typescript-eslint/ban-ts-comment */

/* eslint-disable @typescript-eslint/no-explicit-any */

/**
 * Check the Auth Token
 * @param req Express Request
 * @param res Express Response
 * @param next Express NextFunction
 * @returns {Boolean} If the input token is valid
 */
// eslint-disable-next-line @typescript-eslint/ban-types
// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types
function checkToken(req, res, next) {
  var token = req.header("x-access-token");
  if (!token) return res.status(401).json({
    auth: false,
    error: "No token was provided."
  });

  try {
    var configToken = process.env.TOKEN;

    var verified = _jsonwebtoken["default"].verify(token, configToken); // @ts-ignore


    req.user = verified;
    return next();
  } catch (err) {
    return res.status(400).json({
      auth: false,
      error: "Failed to authenticate token.",
      message: err
    });
  }
}

var _default = checkToken;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9zZXJ2ZXIvUm91dGVyRnVuY3Rpb25zL2NoZWNrVG9rZW4udHMiXSwibmFtZXMiOlsiY2hlY2tUb2tlbiIsInJlcSIsInJlcyIsIm5leHQiLCJ0b2tlbiIsImhlYWRlciIsInN0YXR1cyIsImpzb24iLCJhdXRoIiwiZXJyb3IiLCJjb25maWdUb2tlbiIsInByb2Nlc3MiLCJlbnYiLCJUT0tFTiIsInZlcmlmaWVkIiwiand0IiwidmVyaWZ5IiwidXNlciIsImVyciIsIm1lc3NhZ2UiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFFQTs7OztBQUZBOztBQUNBOztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVNBLFVBQVQsQ0FBcUJDLEdBQXJCLEVBQW1DQyxHQUFuQyxFQUFrREMsSUFBbEQsRUFBc0U7QUFDbEUsTUFBTUMsS0FBSyxHQUFHSCxHQUFHLENBQUNJLE1BQUosQ0FBVyxnQkFBWCxDQUFkO0FBQ0EsTUFBSSxDQUFDRCxLQUFMLEVBQVksT0FBT0YsR0FBRyxDQUFDSSxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUI7QUFBRUMsSUFBQUEsSUFBSSxFQUFFLEtBQVI7QUFBZUMsSUFBQUEsS0FBSyxFQUFFO0FBQXRCLEdBQXJCLENBQVA7O0FBRVosTUFBSTtBQUNBLFFBQU1DLFdBQStCLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxLQUFwRDs7QUFDQSxRQUFNQyxRQUFRLEdBQUdDLHlCQUFJQyxNQUFKLENBQVdaLEtBQVgsRUFBa0JNLFdBQWxCLENBQWpCLENBRkEsQ0FHQTs7O0FBQ0FULElBQUFBLEdBQUcsQ0FBQ2dCLElBQUosR0FBV0gsUUFBWDtBQUNELFdBQU9YLElBQUksRUFBWDtBQUNGLEdBTkQsQ0FNRSxPQUFPZSxHQUFQLEVBQVk7QUFDWCxXQUFPaEIsR0FBRyxDQUFDSSxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUI7QUFBRUMsTUFBQUEsSUFBSSxFQUFFLEtBQVI7QUFBZUMsTUFBQUEsS0FBSyxFQUFFLCtCQUF0QjtBQUF1RFUsTUFBQUEsT0FBTyxFQUFFRDtBQUFoRSxLQUFyQixDQUFQO0FBQ0Y7QUFDSjs7ZUFFY2xCLFUiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXRzLWNvbW1lbnQgKi9cbi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnkgKi9cbmltcG9ydCBqd3QgZnJvbSBcImpzb253ZWJ0b2tlblwiO1xuXG5pbXBvcnQgeyBSZXF1ZXN0LCBSZXNwb25zZSwgTmV4dEZ1bmN0aW9uIH0gZnJvbSBcImV4cHJlc3NcIjtcblxuLyoqXG4gKiBDaGVjayB0aGUgQXV0aCBUb2tlblxuICogQHBhcmFtIHJlcSBFeHByZXNzIFJlcXVlc3RcbiAqIEBwYXJhbSByZXMgRXhwcmVzcyBSZXNwb25zZVxuICogQHBhcmFtIG5leHQgRXhwcmVzcyBOZXh0RnVuY3Rpb25cbiAqIEByZXR1cm5zIHtCb29sZWFufSBJZiB0aGUgaW5wdXQgdG9rZW4gaXMgdmFsaWRcbiAqL1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHlwZXNcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvZXhwbGljaXQtbW9kdWxlLWJvdW5kYXJ5LXR5cGVzXG5mdW5jdGlvbiBjaGVja1Rva2VuIChyZXE6IFJlcXVlc3QsIHJlczogUmVzcG9uc2UsIG5leHQ6IE5leHRGdW5jdGlvbikge1xuICAgIGNvbnN0IHRva2VuID0gcmVxLmhlYWRlcihcIngtYWNjZXNzLXRva2VuXCIpO1xuICAgIGlmICghdG9rZW4pIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGF1dGg6IGZhbHNlLCBlcnJvcjogXCJObyB0b2tlbiB3YXMgcHJvdmlkZWQuXCIgfSk7XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBjb25maWdUb2tlbjogc3RyaW5nIHwgdW5kZWZpbmVkID0gcHJvY2Vzcy5lbnYuVE9LRU47XG4gICAgICAgIGNvbnN0IHZlcmlmaWVkID0gand0LnZlcmlmeSh0b2tlbiwgY29uZmlnVG9rZW4gYXMgc3RyaW5nKTtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICByZXEudXNlciA9IHZlcmlmaWVkO1xuICAgICAgIHJldHVybiBuZXh0KCk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgYXV0aDogZmFsc2UsIGVycm9yOiBcIkZhaWxlZCB0byBhdXRoZW50aWNhdGUgdG9rZW4uXCIsIG1lc3NhZ2U6IGVyciB9KTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNoZWNrVG9rZW47Il19